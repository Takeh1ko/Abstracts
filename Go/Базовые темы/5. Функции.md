# Функции

## Объявление функций

```go
// Простая функция
func hello() {
    fmt.Println("Привет")
}

// С параметрами
func add(a, b int) int {
    return a + b
}

// Несколько параметров одного типа
func multiply(x, y, z float64) float64 {
    return x * y * z
}

// Несколько возвращаемых значений
func divide(a, b float64) (float64, error) {
    if b == 0 {
        return 0, errors.New("деление на ноль")
    }
    return a / b, nil
}

// Именованные возвращаемые значения
func swap(x, y string) (first, second string) {
    first = y
    second = x
    return // автоматически возвращает first, second
}
```

## Вариативные функции

```go
// Переменное количество аргументов
func sum(numbers ...int) int {
    total := 0
    for _, num := range numbers {
        total += num
    }
    return total
}

// Использование
result := sum(1, 2, 3, 4, 5)
nums := []int{1, 2, 3}
result2 := sum(nums...) // распаковка слайса
```

## Анонимные функции

```go
// Анонимная функция
func main() {
    // Объявление и вызов
    func() {
        fmt.Println("анонимная функция")
    }()
    
    // Присвоение переменной
    square := func(x int) int {
        return x * x
    }
    fmt.Println(square(5))
}
```

## Замыкания

```go
// Замыкание
func counter() func() int {
    count := 0
    return func() int {
        count++
        return count
    }
}

// Использование
c := counter()
fmt.Println(c()) // 1
fmt.Println(c()) // 2
```

## Функции как параметры

```go
// Функция как параметр
func apply(fn func(int) int, value int) int {
    return fn(value)
}

// Использование
double := func(x int) int { return x * 2 }
result := apply(double, 5) // 10

// Встроенная функция
result2 := apply(func(x int) int { return x * x }, 4) // 16
```

## Defer

```go
// defer - выполнение в конце функции
func example() {
    defer fmt.Println("выполнится последним")
    fmt.Println("выполнится первым")
    defer fmt.Println("выполнится предпоследним")
}

// Типичное использование
func readFile(filename string) error {
    file, err := os.Open(filename)
    if err != nil {
        return err
    }
    defer file.Close() // закрытие в конце функции
    
    // работа с файлом
    return nil
}
```

## Методы

```go
// Метод для типа
type Rectangle struct {
    width, height float64
}

// Метод с получателем по значению
func (r Rectangle) Area() float64 {
    return r.width * r.height
}

// Метод с получателем по указателю
func (r *Rectangle) Scale(factor float64) {
    r.width *= factor
    r.height *= factor
}

// Использование
rect := Rectangle{3, 4}
fmt.Println(rect.Area()) // 12
rect.Scale(2)           // изменяет rect
```